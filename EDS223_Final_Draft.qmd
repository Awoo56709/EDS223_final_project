---
title: "Identifying Optimal Environments for Aquaculture"
author: Joshua Ferrer-Lozano
affiliation: Master of Environmental Data Science
date: 2025-11-28
categories: [R, MEDS, data-viz, Geospatial]
format:
  html:
    toc: true
    code-fold: false
    embed-resources: true
draft: false
execute: 
  warning: false
  message: false
---

# Introduction

As global demand for seafood continues to rise, pressure on wild fisheries has intensified. Marine aquaculture offers a sustainable alternative, reducing reliance on wild stocks while supporting economic growth. Research suggests that the availability of suitable ocean space will not constrain aquaculture expansion (Gentry et al., 2017), creating opportunities for countries like the United States to develop systems that balance economic and environmental objectives.

This project evaluates the suitability of U.S. West Coast Exclusive Economic Zones (EEZs) for oyster aquaculture by examining two key environmental factors: sea surface temperature (SST) and bathymetry. Using satellite‑derived SST data (2008–2012) and regional bathymetry, we quantify areas that meet oyster‑specific thresholds. By integrating spatial data with habitat requirements, this study identifies where conditions are most favorable for expanding sustainable oyster aquaculture along the West Coast.

# Research Question

Where along the U.S. West Coast are environmental conditions most suitable for oyster aquaculture?

# Background

Aquaculture is increasingly recognized as a critical component of global food security and coastal economies, yet identifying where species can thrive requires careful integration of environmental data. In this blog post, we will identify where along the U.S. West Coast are environmental conditions most suitable for oyster aquaculture. Using sea surface temperature (SST) data, bathymetry rasters, and Exclusive Economic Zone (EEZ) boundaries, we identify areas most favorable for oyster cultivation. By combining geospatial modeling with cartographic visualization, we highlight how environmental data science can inform sustainable aquaculture planning.

# Highlights of the Analysis

- **Raster Reclassification**: Converted SST and depth rasters into binary suitability maps based on oyster thresholds.
- **Map Algebra**: Combined multiple criteria (temperature × depth) to produce a composite suitability raster.
- **Zonal Statistics**: Summed suitable areas within EEZ boundaries to quantify aquaculture potential by region.
- **Cartographic Visualization**: Produced clear maps with legends, units, and orientation cues to communicate results effectively.
- Used geospatial tools including **R**, the `terra` and `stars` package.

These steps illustrate how spatial data science integrates multiple datasets to answer applied environmental questions.

# Dataset Descriptions

- **Sea Surface Temperature (2008–2012)**: NOAA Coral Reef Watch 5‑km SST data, averaged across five years and converted from Kelvin to Celsius.
- **Bathymetry**: GEBCO gridded bathymetry dataset, reprojected and resampled to align with SST rasters.
- **Exclusive Economic Zones (EEZs)**: Marine Regions shapefiles defining U.S. West Coast EEZ boundaries.
- **Species Requirements**: Oyster depth and temperature preferences from SeaLifeBase.

# Methods

The workflow begins with preprocessing SST and bathymetry data, followed by reclassification into suitability ranges, combining criteria with map algebra, and aggregating results by EEZ.

This geospatial analysis utilized key concepts such as:
- Combining raster and vector data
- Resampling raster data
- Map algebra
- Zonal statistics

# Analysis 1: Mean Sea Surface Temperature

## Step 1: Load Libraries and Import Data

We begin by loading libraries and importing EEZ boundaries, bathymetry, and SST rasters.
```{r}
# Load libraries for geospatial and data analysis
suppressPackageStartupMessages({
library(tidyverse)   # Data wrangling and plotting
library(stars)       # Raster handling
library(terra)       # Raster operations
library(sf)          # For vector data
library(tmap)        # For visualization
library(knitr)       # Table formatting
library(kableExtra)  # Table formatting
})
```

```{r}
# Read in Exclusive Economic Zone (EEZ) shapefile
regions_clean <- st_read("data/wc_regions_clean.shp")

# Read in depth raster
depth <- rast("data/depth.tif")

# Read in Sea Surface Temperature rasters
sst_2008 <- rast("data/average_annual_sst_2008.tif")
sst_2009 <- rast("data/average_annual_sst_2009.tif")
sst_2010 <- rast("data/average_annual_sst_2010.tif")
sst_2011 <- rast("data/average_annual_sst_2011.tif")
sst_2012 <- rast("data/average_annual_sst_2012.tif")
```
## Step 2: Process the Data

We assume WGS84 (EPSG:4326) as the common CRS, verify CRS, stack the five rasters (2008 - 2012), calculate the mean and convert Kelvin to Celsius

```{r}
# Stack SST rasters into multi-layer Spatraster
sst_stack <- c(sst_2008, sst_2009, sst_2010, sst_2011, sst_2012)

# Compute the mean of SST across years
sst_mean <- mean(sst_stack)

# Convert Kelvin to Celsius
sst_celsius <- sst_mean - 273.15

# Replace NA values with 0
sst_celsius[is.na(sst_celsius)] <- 0

# Add warning if the range is wrong
if (max(values(sst_celsius), na.rm=TRUE) > 40) warning("SST unusually high — check conversion.")
```

Plot Mean Surface Temperature on West Coast
```{r}
# Convert SST raster to stars object for a more robust plot
sst_stars <- st_as_stars(sst_celsius)

tm_shape(sst_stars) +
  tm_raster(fill.scale = tm_scale(values = "viridis"),
            fill.legend = tm_legend(title = "Temperature (C)")) +
  tm_title("Mean Sea Surface Temperature (°C, 2008–2012)", position = c("center", "top")) +
  tm_scalebar(position = c("left", "bottom")) +
  tm_compass(position = c("right", "bottom"))

```
Figure 1: The mean sea surface temperature (SST) raster from the years 2008 - 2012 provides insight into the temperature variation along the west coast of the united states from California to Washington state with warmer waters on average in the southern regions and cooler in the northern regions.

## Step 3: Reproject, crop and resample bathymetry to SST resolution

```{r}
# Align depth raster to the SST raster

# Reproject CRS
depth_proj <- project(depth, crs(sst_celsius))  
# Crop to SST extent
depth_crop <- crop(depth_proj, sst_celsius)
# Resample resolution
depth_resample <- resample(depth_crop, sst_celsius, method = "near") 
```
Re-sampling with the nearest neighbor preserves categorical depth bins.

## Step 4: Verify Alignments
```{r}
# Verify alignments of CRS, resolution and extent
crs(sst_celsius) == crs(depth_resample)
if (!identical(res(sst_celsius), res(depth_resample))) stop("Resolution mismatch.")
```
Verify CRS, resolution and extent match.

## Step 5: Identify Suitable Environments for Oysters

Next, we identify suitable oyster environments by reclassifying SST and depth rasters into binary maps.

According to research, favorable environments for oysters include:
- Sea surface temperature (SST) range: 11 - 30 degrees Celsius
- Depth Range: 0 - 70 meters

We reclassify SST and depth rasters into binary suitability maps and combine them.
```{r}
# Create matrix to reclassify SST suitability for oysters based on 11–30 C
sst_suit <- classify(sst_celsius,
                     rbind(c(-Inf, 11, 0), # Unsuitable temp below 11 C
                           c(11, 30, 1),   # Suitable temp at 11 - 30 C
                           c(30, Inf, 0))) # Unsuitable temp above 30 C

# Create matrix to reclassify depth suitability for oysters based on 0–70 m
depth_suit <- classify(depth_resample,
                       rbind(c(-Inf, -70, 0),  # Unsuitable elevation above sea level
                             c(-70, 0, 1),     # Suitable between -70 - 0 m sea level
                             c(0, Inf, 0)))    # Unsuitable elevation above sea level

# Test to verify our matrix of binary output
testthat::expect_true(all(unique(values(sst_suit)) %in% c(0,1)))


# Combine suitability (map algebra: both must be 1)
suitability <- sst_suit * depth_suit
```
We assume depths are negative, so suitable oyster depths are −70 to 0 m. If positive, thresholds would be 0–70.

## Step 6: Convert Raster to Dataframe and Plot

```{r}
# Convert raster to dataframe
suit_df <- as.data.frame(suitability, xy = TRUE, na.rm = TRUE)

# Plot with ggplot
ggplot(suit_df) +
  geom_raster(aes(x = x, y = y, fill = factor(mean))) +
  scale_fill_manual(values = c("0" = "purple", "1" = "gold"),
                    name = "Oyster suitability",
                    labels = c("Unsuitable", "Suitable")) +
  labs(title = "Combined Suitability (Oysters)") +
  theme_minimal()
```
Figure 2: Combined suitability raster. Gold areas represent suitable oyster environments, purple areas unsuitable.”

## Step 7: Suitability by EEZ

We aggregate suitable habitat by EEZ using zonal statistics, which sum the total suitable area (km^2) within each EEZ boundary.
```{r}
# Convert EEZ polygons to terra vector
eez_v <- vect(regions_clean)
# Align CRS
eez_v <- project(eez_v, crs(sst_celsius))

# Rasterize EEZ IDs to each polygon
eez_v$eez_id <- seq_len(nrow(eez_v))
eez_r <- rasterize(eez_v, sst_celsius, field = "eez_id")

# Calculate cell area in km^2
cell_area <- cellSize(sst_celsius, unit = "km")

# Multiply suitable area raster by cell to get suitable area per cell
area_suitable <- suitability * cell_area

# Zonal sum of suitable area per EEZ
area_by_eez <- zonal(area_suitable, eez_r, fun = "sum", na.rm = TRUE)

# Convert to data frame and rename columns correctly
area_by_eez <- as.data.frame(area_by_eez) |> 
  dplyr::rename(suitable_km2 = mean)

# Join zonal statistics to EEZ polygons
eez_sf_out <- st_as_sf(eez_v) |> 
  left_join(area_by_eez, by = "eez_id")
```
Convert EEZ polygons to vector, aligned the CRS, rasterized EEZ IDs, applied map algebra, converted to data frame.  Summing suitable cell areas by EEZ allows us to rank zones by aquaculture potential. Lastly, I joined zonal statistics to EEZ polygons.


# Results

```{r}
# Calculate totals and add EEZ names
total_area <- sum(area_by_eez$suitable_km2, na.rm = TRUE)

area_table <- area_by_eez |> 
  arrange(desc(suitable_km2)) |> 
  mutate(
    Percent = round((suitable_km2 / total_area) * 100, 1),
    EEZ_Name = case_when(
      eez_id == 1 ~ "Washington (WA)",
      eez_id == 2 ~ "Oregon (OR)",
      eez_id == 3 ~ "Northern California (CA-N)",
      eez_id == 4 ~ "Central California (CA-C)",
      eez_id == 5 ~ "Southern California (CA-S)",
      TRUE ~ paste("EEZ", eez_id)
    )
  )

# Prepare a table with formatting for display
area_table_display <- area_table |> 
  transmute(
    Rank = row_number(),              # Ranked by suitable_km2 due to arrange()
    `EEZ Region` = EEZ_Name,
    `Suitable Area (km^2)` = round(suitable_km2, 2),
    `% of Total` = Percent
  )

# Style the table with header and row colors
n_rows <- nrow(area_table_display)

area_table_display |> 
  knitr::kable(
    caption = "EEZ rankings by suitable oyster aquaculture area"
  ) |> 
  kableExtra::kable_classic(full_width = FALSE, position = "center") |> 
  kableExtra::row_spec(0, bold = TRUE, background = "#2E4057", color = "white") |>
  kableExtra::row_spec(1:n_rows, background = "#F1F4F8")

```
Table 1: EEZ rankings by suitable oyster aquaculture area. Northern and Central California together account for over 60% of all suitable habitat.


```{r}

# Plot tmap
tm_basemap("Esri.OceanBasemap", alpha = 0.6) +
tm_shape(eez_sf_out) +
  tm_polygons("suitable_km2",
              palette = "blues",  # Accessible cool-to-hot palette
              title = "Suitable Area (km²)",
              border.col = "grey30",
              border.lwd = 0.6) +
  tm_text("rgn_key",     
          size = 0.9,
          col = "white",
          fontface = "bold",
          xmod = -0.3, # Adjust horizontal offset
          ymod = 0.2) + # Adjust vertical offset
  tm_layout(main.title = "Oyster Aquaculture Suitability by EEZ",
            main.title.size = 1.1,
            legend.outside = TRUE,
            frame = FALSE,
            bg.color = "lightblue") + # Background color behind basemap
  tm_compass(type = "4star", position = c("right", "top")) +
  tm_scalebar(position = c("left", "bottom"))

  
```
Figure 3: Oyster aquaculture suitability by EEZ. Southern California and Central California emerge as the most promising zones.

# Findings
- Oyster aquaculture suitability is concentrated in specific EEZs along the West Coast.

- Combining SST and depth thresholds provides a robust method for identifying viable cultivation zones.

- Zonal statistics allow policymakers to compare aquaculture potential across regions.

- Southern EEZs (Southern, Central and Northern California) show the largest suitable areas.


# Discussion

This analysis demonstrates how spatial data science can inform sustainable aquaculture planning. By integrating environmental thresholds with geospatial data sets, we identified where oysters are most likely to thrive along the U.S. West Coast. The results reveal clear spatial patterns of suitability, with Central and Southern California emerging as the most promising regions, while Washington and Oregon also contain meaningful but smaller areas of potential habitat.

However, this model does take into account confounding variables. The model does not account for salinity, pollution, disease risk, or human use conflicts such as shipping lanes and fishing grounds. Incorporating these additional variables would provide a more holistic view of aquaculture feasibility. Previous studies highlight how aquaculture planning must balance ecological constraints with sustainable development goals (FAO, 2024), underscoring the importance of expanding analyses beyond physical thresholds.

Future research could extend this framework to other species with distinct environmental requirements or to climate change scenarios that alter SST and ocean depth dynamics. The methods demonstrated raster reclassification, map algebra, and zonal statistics—are versatile tools that can be applied to other contexts, such as identifying suitable elevations for grapevines or climate niches for tree species. By broadening the scope, environmental data science can continue to guide sustainable aquaculture development and ecosystem management.

```{r}
# Function to map EEZ suitability for a species
map_species_suitability <- function(sst_min, sst_max, depth_min, depth_max, species_name) {
  
# Read in data
  regions_clean <- st_read("data/wc_regions_clean.shp", quiet = TRUE)
  depth <- rast("data/depth.tif")
  sst_stack <- c(
    rast("data/average_annual_sst_2008.tif"),
    rast("data/average_annual_sst_2009.tif"),
    rast("data/average_annual_sst_2010.tif"),
    rast("data/average_annual_sst_2011.tif"),
    rast("data/average_annual_sst_2012.tif")
  )
  
  # Process the SST and convert to celsius
  sst_mean <- mean(sst_stack)
  sst_celsius <- sst_mean - 273.15
  
  # Align depth to SST
  depth_proj <- project(depth, crs(sst_celsius))
  depth_crop <- crop(depth_proj, sst_celsius)
  depth_resample <- resample(depth_crop, sst_celsius, method = "near")
  
  # Create suitability classification matrixes
  sst_suit <- classify(sst_celsius,
                       rbind(c(-Inf, sst_min, 0),
                             c(sst_min, sst_max, 1),
                             c(sst_max, Inf, 0)))
  
  depth_suit <- classify(depth_resample,
                         rbind(c(-Inf, depth_min, 0),
                               c(depth_min, depth_max, 1),
                               c(depth_max, Inf, 0)))
  
  suitability <- sst_suit * depth_suit
  
  # Create EEZ zonal stats
  
  # Convert cleaned EEZ regions to vector
  eez_v <- vect(regions_clean)
  
  # Reproject the EEZ vector to match CRS of sst_celsius
  eez_v <- project(eez_v, crs(sst_celsius))
  
  # Add unique ID for each EEZ zone for later join
  eez_v$eez_id <- seq_len(nrow(eez_v))
  
  # Rasterize the EEZ polygon so each cell in raster is assigned an ID that is within
  eez_r <- rasterize(eez_v, sst_celsius, field = "eez_id")
  
  # Calculate the area of each raster in square kilometers
  cell_area <- cellSize(sst_celsius, unit = "km")
  
  # Multiply the suitability raster by cell area to get area of suitable habitat per cell
  area_suitable <- suitability * cell_area
  
  # Perform zonal math by getting the sum of the suitable area in each EEZ zone
  area_by_eez <- zonal(area_suitable, eez_r, fun = "sum", na.rm = TRUE)
  
  # Convert above results into a dataframe and rename column
  area_by_eez <- as.data.frame(area_by_eez) |> 
    rename(suitable_km2 = mean)
  
  # Convert EEZ vector back to an sf obejct and join stats by EEZ ID
  eez_sf_out <- st_as_sf(eez_v) |> 
    left_join(area_by_eez, by = "eez_id")
  
# Plot map
  tm_shape(eez_sf_out) +
    tm_polygons(fill = "suitable_km2",
                fill.scale = tm_scale(values = "viridis"),
                fill.legend = tm_legend(title = "Suitable area (km²)")) +
    tm_title(paste(species_name, "Suitability Across West Coast EEZs"),
             position = c("center", "top")) +
    tm_scalebar(position = c("left", "bottom")) +
    tm_compass(position = c("right", "top"))
}
```

```{r}
# Use the function for finding suitable area for Geoducks

# map_species_suitability(sst_min, sst_max, depth_min, depth_max, species_name)
map_species_suitability(sst_min = 0, sst_max = 80, depth_min = -100, depth_max = 0, species_name = "Geoduck")

```


# References

SeaLifeBase. (2025). Species depth and temperature requirements. https://www.sealifebase.ca/search.php [Accessed Nov. 2025]

NOAA Coral Reef Watch. (2025). 5‑km Sea Surface Temperature Anomaly Product. https://coralreefwatch.noaa.gov/product/5km/index_5km_ssta.php [Accessed Nov. 2025]

GEBCO. (2025). Gridded Bathymetry Data. https://www.gebco.net/data-products/gridded-bathymetry-data#area [Accessed Nov. 2025]

Marine Regions. (2025). Exclusive Economic Zones (EEZs). https://www.marineregions.org/eez.php [Accessed Nov. 2025]

